# Chapter09. Diffuse Materials
- 디퓨즈 재질(확산 반사) 은 빛을 임의의 방향으로 반사시키며, 광선마다 서로 다른 산란 경로를 가짐
- 지오메트리와 재질은 분리되어 관리되며, 여러 객체에 재질을 공유할 수 있음
- 초기 구현은 반구 위에 균등 산란되는 랜덤 벡터를 사용
- 반사광이 생성된 표면의 법선과 같은 반구에 존재하도록 `random_on_hemisphere()`를 사용
- 재귀적으로 반사되는 광선의 깊이를 제한하여 스택 오버플로우 방지
- 섀도우 여드름(Shadow Acne) 문제는 매우 가까운 교차를 무시하는 방식(t_min = 0.001)으로 해결

## True Lambertian Reflection
- 균일한 반구 산란보다 람버시안 분포(Lambertian distribution) 가 실제 확산 반사를 더 정확하게 표현
- 법선 벡터에 `random_unit_vector()`를 더해 법선 방향으로 더 많은 광선을 산란
- 결과적으로 그림자가 더 깊고, 하늘색 간접 조명 효과도 강해짐

## Gamma Correction
- 렌더링된 색상이 실제 반사율보다 어둡게 보이는 현상은 감마 보정이 없기 때문
- 대부분의 이미지 뷰어는 감마 보정된(gamma space) 이미지를 기대하지만, 렌더러는 선형 공간(linear space)으로 출력
- 이를 보정하기 위해 출력 전에 각 색상 성분에 루트 연산(√x)을 적용 (gamma 2 보정)
- `write_color()`에 감마 보정을 적용하면 밝기 변화가 시각적으로 일관성 있게 표현